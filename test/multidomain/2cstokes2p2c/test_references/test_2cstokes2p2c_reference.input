#############################################################
#Configuration file for test_2cstokes2p2c
#############################################################

#############################################################
[Problem]
#############################################################
#First part of the interface, where it is not coupled;
#set to zero or negative if not desired
RunUpDistanceX = 0.0
NoDarcyX = 0.0

#############################################################
[TimeManager]
#############################################################
#Initial and maximum time-step size
DtInitial = 5e-1
MaxTimeStepSize = 360

#Initialization time without coupling
#set to zero or negative if not desired
InitTime = 0

#Simulation end
TEnd= 7200

#Define the length of an episode (for output)
EpisodeLength = 43200

#############################################################
[Vtk]
#############################################################
#Names for VTK output
NameFF = stokes2c
NamePM = 2p2c
AddVelocity = 1

#############################################################
[Grid]
#############################################################
UseInterfaceMeshCreator = true

#Name of the dgf file (grid)
File = grids/interfacedomain.dgf
Refinement = 0

#Number of elements in x-, y-, z-direction
CellsX = 15
CellsY = 45
CellsZ = 1
#Grading and refinement of the mesh in y direction
Grading = 1.13

#Extend of the entire domain
XMin = 0.0
XMax = 0.25
YMin = 0.0
YMax = 0.5

#Vertical position of coupling interface
InterfacePos = 0.25

#############################################################
[Output]
#############################################################
#Frequency of restart file, flux and VTK output
FreqRestart = 1000      # how often restart files are written out 
FreqOutput = 1          # frequency of VTK output
FreqMassOutput = 1      # frequency of mass and evaporation rate output (Darcy)
FreqFluxOutput = 5      # frequency of detailed flux output
FreqVaporFluxOutput = 1 # frequency of summarized flux output

#############################################################
[Stokes]
#############################################################
StabilizationAlpha = -1.0

#############################################################
[FreeFlow]
#############################################################
RefVelocity = 3.5
RefPressure = 1e5
RefMassfrac = 0.008          # 0.01
RefTemperature = 298.15
SinusVelAmplitude = 0.0           # 0.1
SinusVelPeriod = 3600             # in seconds
SinusPressureAmplitude = 0.0      # 0.5
SinusPressurePeriod = 3600        # in seconds
SinusConcentrationAmplitude = 0.0 # 0.5
SinusConcentrationPeriod = 3600   # in seconds
SinusTemperatureAmplitude = 0.0   # 0.5
SinusTemperaturePeriod = 3600     # in seconds
BeaversJosephSlipVel = 0.00134
ExponentMTC = 0.0           # 1./6., Mass transfer coefficient for S^MTC
UseBoundaryLayerModel = 0   # 0 for no boundary layer model, 1 for Blasius, 2 and 3 for turbulent BL, 9 for constant thickness
BoundaryLayerOffset = 0.0   # for BL model like Blasius, determines a virtual run-up distance for the flow
ConstThickness = 0.0016     # for a constant BL thickness, use BL model 9
MassTransferModel = 0       # 0 for none, 1 for power law, 2 for Schluender model

#############################################################
[PorousMedium]
#############################################################
RefPressurePM = 1e5
RefTemperaturePM = 298.15
InitialSw1 = 0.05
InitialSw2 = 0.05
CharPoreDiameter = 1e-4     # for Schluender mass-transfer model

#############################################################
[SpatialParams]
#############################################################
MaterialInterfaceX = 100.0
AlphaBJ = 1.0

# for homogeneous setups (0 for heterogeneous):
SoilType = 2
RegularizationThreshold = 1e-2 # linearization threshold for pc-Sw

# GStat stuff, only required for SoilType=0
GenerateNewPermeability = true
GStatControlFileName = gstatControl_2D.txt
GStatInputFileName = gstatInput.txt
PermeabilityInputFileName = permeab.dat

### SoilType = 1 ### 
[SpatialParams.Coarse]
Permeability1 = 7.0e-10
Porosity1 = 0.44
Swr1 = 0.005
Snr1 = 0.01
VgAlpha1 = 8.74e-4
VgN1 = 3.35
PlotMaterialLaw1 = false
LambdaSolid1 = 5.3

### SoilType = 2 ###
[SpatialParams.Medium]
Permeability2 = 2.65e-10
Porosity2 = 0.41
Swr2 = 0.005
Snr2 = 0.01
VgAlpha2 = 6.371e-4
VgN2 = 6.9
PlotMaterialLaw2 = false 
LambdaSolid2 = 5.3

### SoilType = 3 ###
[SpatialParams.Fine]
Permeability3 = 1.06e-10
Porosity3 = 0.334
Swr3 = 0.028
Snr3 = 0.01
VgAlpha3 = 5.81e-4
VgN3 = 17.8
PlotMaterialLaw3 = false
LambdaSolid3 = 5.3

#############################################################
[Newton]
#############################################################
MaxRelativeShift = 1e-5
TargetSteps = 8
MaxSteps = 12
WriteConvergence = false
MaxTimeStepDivisions = 20

#############################################################
[LinearSolver]
#############################################################
ResidualReduction = 1e-10
Verbosity = 0
MaxIterations = 200
